import{jsx as e,jsxs as t,Fragment as l}from"react/jsx-runtime";import{Group as a}from"@visx/group";import{Pie as i}from"@visx/shape";import o from"clsx";import{useCallback as n,createContext as r,useContext as s}from"react";import{localPoint as d}from"@visx/event";import{useTooltip as c}from"@visx/tooltip";import{LegendOrdinal as m}from"@visx/legend";import{scaleOrdinal as p}from"@visx/scale";import{useParentSize as h}from"@visx/responsive";const g={backgroundColor:"#FFFFFF",labelBackgroundColor:"#FFFFFF",colors:["#98C8DF","#006DAB","#A6DC80","#1F9828","#FF8C8F"],gridStyles:{stroke:"#787C82",strokeWidth:1},tickLength:0,gridColor:"",gridColorDark:""},u=r(g);var v={"legend--horizontal":"legend-module__legend--horizontal__IUN13","legend--vertical":"legend-module__legend--vertical__Scfzo","legend-item":"legend-module__legend-item__feemn","legend-item-swatch":"legend-module__legend-item-swatch__nRyXf","legend-item-label":"legend-module__legend-item-label__ksx6I","legend-item-value":"legend-module__legend-item-value__d9x1j"};const f={horizontal:"row",vertical:"column"},_=({items:l,className:a,orientation:i="horizontal"})=>{const n=p({domain:l.map((e=>e.label)),range:l.map((e=>e.color))});return e("div",{className:o(v.legend,v[`legend--${i}`],a),role:"list",children:e(m,{scale:n,direction:f[i],shape:"rect",shapeWidth:16,shapeHeight:16,className:v["legend-items"],children:a=>e("div",{className:v[`legend--${i}`],children:a.map((a=>t("div",{className:v["legend-item"],children:[e("svg",{width:16,height:16,children:e("rect",{width:16,height:16,fill:a.value,className:v["legend-item-swatch"]})}),t("span",{className:v["legend-item-label"],children:[a.text,l.find((e=>e.label===a.text))?.value&&e("span",{className:v["legend-item-value"],children:l.find((e=>e.label===a.text))?.value})]})]},a.text)))})})})};var x="base-tooltip-module__tooltip__OfX6n";const b=({data:e})=>t(l,{children:[e?.label,": ",e?.valueDisplay||e?.value]}),N=({data:t,top:l,left:a,component:i=b,children:o,className:n})=>e("div",{className:x,style:{top:l,left:a},role:"tooltip",children:o||t&&e(i,{data:t,className:n})});var w={"pie-chart":"pie-chart-module__pie-chart__R12Vh"};const F=({data:l,withTooltips:r=!1,className:m,showLegend:p,legendOrientation:h,size:v,thickness:f=1,padding:x=20,gapScale:b=0,cornerScale:F=0})=>{const M=s(u),{onMouseMove:C,onMouseLeave:T,tooltipOpen:k,tooltipData:y,tooltipLeft:D,tooltipTop:L}=(({withTooltips:e})=>{const{tooltipOpen:t,tooltipLeft:l,tooltipTop:a,tooltipData:i,hideTooltip:o,showTooltip:r}=c();return{onMouseMove:n(((t,l)=>{if(!e)return;const a=d(t);a&&r({tooltipData:l,tooltipLeft:a.x,tooltipTop:a.y-10})}),[e,r]),onMouseLeave:n((()=>{e&&o()}),[e,o]),tooltipOpen:t,tooltipData:i||null,tooltipLeft:l,tooltipTop:a}})({withTooltips:r}),{isValid:z,message:R}=(e=>{if(!e.length)return{isValid:!1,message:"No data available"};if(e.some((e=>e.percentage<0||e.value<0)))return{isValid:!1,message:"Invalid data: Negative values are not allowed"};const t=e.reduce(((e,t)=>e+t.percentage),0);return Math.abs(t-100)>.01?{isValid:!1,message:"Invalid percentage total: Must equal 100"}:{isValid:!0,message:""}})(l);if(!z)return e("div",{className:o("pie-chart",w["pie-chart"],m),children:e("div",{className:w["error-message"],children:R})});const A=v,S=v,V=Math.min(A,S)/2,$=A/2,B=S/2,I=b*(2*Math.PI/l.length),O=V-x,P=O*(1-f),W=(O-P)/2,j=F?Math.min(F*O,W):0,H=l.map(((e,t)=>({...e,index:t}))),X={value:e=>e.value,fill:e=>e?.color||M.colors[e.index]},q=l.map(((e,t)=>({label:e.label,value:e.value.toString(),color:M.colors[t%M.colors.length]})));return t("div",{className:o("pie-chart",w["pie-chart"],m),children:[e("svg",{viewBox:`0 0 ${v} ${v}`,preserveAspectRatio:"xMidYMid meet",children:e(a,{top:B,left:$,children:e(i,{data:H,pieValue:X.value,outerRadius:O,innerRadius:P,padAngle:I,cornerRadius:j,children:l=>l.arcs.map(((a,i)=>{const[o,n]=l.path.centroid(a),s=a.endAngle-a.startAngle>=.25,d=e=>C(e,a.data),c={d:l.path(a)||"",fill:X.fill(a.data)};return r&&(c.onMouseMove=d,c.onMouseLeave=T),t("g",{children:[e("path",{...c}),s&&e("text",{x:o,y:n,dy:".33em",fill:M.labelBackgroundColor||g.labelBackgroundColor,fontSize:12,textAnchor:"middle",pointerEvents:"none",children:a.data.label})]},`arc-${i}`)}))})})}),p&&e(_,{items:q,orientation:h,className:w["pie-chart-legend"]}),r&&k&&y&&e(N,{data:y,top:L||0,left:D||0,style:{transform:"translate(-50%, -100%)"}})]})};F.displayName="PieChart";var M=function(t,l){const{maxWidth:a=1200,aspectRatio:i=.5,debounceTime:o=50}=l||{};return function(l){const{parentRef:n,width:r}=h({debounceTime:o,enableDebounceLeadingCall:!0,initialSize:{width:600,height:400}}),s=r?Math.min(r,a):600,d=s*i;return e("div",{ref:n,style:{width:"100%",minHeight:`${d}px`},children:e(t,{width:s,height:d,size:s,...l})})}}(F);export{M as PieChart};
//# sourceMappingURL=index.js.map
