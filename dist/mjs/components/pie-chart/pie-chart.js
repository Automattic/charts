import{jsx as e,jsxs as a}from"react/jsx-runtime";import{Group as t}from"@visx/group";import{Pie as o}from"@visx/shape";import r from"clsx";import"react";import i from"../../hooks/use-chart-mouse-handler.js";import{useChartTheme as l}from"../../providers/theme/theme-provider.js";import{defaultTheme as s}from"../../providers/theme/themes.js";import{BaseLegend as n}from"../legend/base-legend.js";import{withResponsive as d}from"../shared/with-responsive.js";import{BaseTooltip as p}from"../tooltip/base-tooltip.js";import m from"./pie-chart.module.scss.js";const c=({data:d,withTooltips:c=!1,className:h,showLegend:u,legendOrientation:g,size:v,thickness:f=1,padding:M=20,gapScale:x=0,cornerScale:b=0,children:j=null})=>{const N=l(),{onMouseMove:w,onMouseLeave:V,tooltipOpen:A,tooltipData:k,tooltipLeft:y,tooltipTop:L}=i({withTooltips:c}),{isValid:R,message:S}=(e=>{if(!e.length)return{isValid:!1,message:"No data available"};if(e.some((e=>e.percentage<0||e.value<0)))return{isValid:!1,message:"Invalid data: Negative values are not allowed"};const a=e.reduce(((e,a)=>e+a.percentage),0);return Math.abs(a-100)>.01?{isValid:!1,message:"Invalid percentage total: Must equal 100"}:{isValid:!0,message:""}})(d);if(!R)return e("div",{className:r("pie-chart",m["pie-chart"],h),children:e("div",{className:m["error-message"],children:S})});const B=v,C=v,I=Math.min(B,C)/2,T=B/2,$=C/2,z=x*(2*Math.PI/d.length),O=I-M,P=O*(1-f),q=(O-P)/2,D=b?Math.min(b*O,q):0,E=d.map(((e,a)=>({...e,index:a}))),Y={value:e=>e.value,fill:e=>e?.color||N.colors[e.index]},F=d.map(((e,a)=>({label:e.label,value:e.value.toString(),color:N.colors[a%N.colors.length]})));return a("div",{className:r("pie-chart",m["pie-chart"],h),children:[e("svg",{viewBox:`0 0 ${v} ${v}`,preserveAspectRatio:"xMidYMid meet",width:v,height:v,children:a(t,{top:$,left:T,children:[e(o,{data:E,pieValue:Y.value,outerRadius:O,innerRadius:P,padAngle:z,cornerRadius:D,children:t=>t.arcs.map(((o,r)=>{const[i,l]=t.path.centroid(o),n=o.endAngle-o.startAngle>=.25,d=e=>w(e,o.data),p={d:t.path(o)||"",fill:Y.fill(o.data)};return c&&(p.onMouseMove=d,p.onMouseLeave=V),a("g",{children:[e("path",{...p}),n&&e("text",{x:i,y:l,dy:".33em",fill:N.labelBackgroundColor||s.labelBackgroundColor,fontSize:12,textAnchor:"middle",pointerEvents:"none",children:o.data.label})]},`arc-${r}`)}))}),j]})}),u&&e(n,{items:F,orientation:g,className:m["pie-chart-legend"]}),c&&A&&k&&e(p,{data:k,top:L||0,left:y||0,style:{transform:"translate(-50%, -100%)"}})]})};c.displayName="PieChart";var h=d(c);export{h as default};
//# sourceMappingURL=pie-chart.js.map
