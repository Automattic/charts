import{jsx as e,jsxs as a}from"react/jsx-runtime";import{Group as t}from"@visx/group";import{Pie as o}from"@visx/shape";import r from"clsx";import"react";import i from"../../hooks/use-chart-mouse-handler.js";import{useChartTheme as s}from"../../providers/theme/theme-provider.js";import{defaultTheme as l}from"../../providers/theme/themes.js";import{BaseLegend as n}from"../legend/base-legend.js";import{withResponsive as d}from"../shared/with-responsive.js";import{BaseTooltip as p}from"../tooltip/base-tooltip.js";import m from"./pie-chart.module.scss.js";const c=({data:d,withTooltips:c=!1,className:h,showLegend:u,legendOrientation:g,size:v,thickness:f=1,padding:M=20,gapScale:x=0,cornerScale:b=0})=>{const j=s(),{onMouseMove:N,onMouseLeave:w,tooltipOpen:V,tooltipData:A,tooltipLeft:k,tooltipTop:y}=i({withTooltips:c}),{isValid:L,message:R}=(e=>{if(!e.length)return{isValid:!1,message:"No data available"};if(e.some((e=>e.percentage<0||e.value<0)))return{isValid:!1,message:"Invalid data: Negative values are not allowed"};const a=e.reduce(((e,a)=>e+a.percentage),0);return Math.abs(a-100)>.01?{isValid:!1,message:"Invalid percentage total: Must equal 100"}:{isValid:!0,message:""}})(d);if(!L)return e("div",{className:r("pie-chart",m["pie-chart"],h),children:e("div",{className:m["error-message"],children:R})});const S=v,B=v,C=Math.min(S,B)/2,I=S/2,T=B/2,$=x*(2*Math.PI/d.length),z=C-M,O=z*(1-f),P=(z-O)/2,q=b?Math.min(b*z,P):0,D=d.map(((e,a)=>({...e,index:a}))),E={value:e=>e.value,fill:e=>e?.color||j.colors[e.index]},Y=d.map(((e,a)=>({label:e.label,value:e.value.toString(),color:j.colors[a%j.colors.length]})));return a("div",{className:r("pie-chart",m["pie-chart"],h),children:[e("svg",{viewBox:`0 0 ${v} ${v}`,preserveAspectRatio:"xMidYMid meet",width:v,height:v,children:e(t,{top:T,left:I,children:e(o,{data:D,pieValue:E.value,outerRadius:z,innerRadius:O,padAngle:$,cornerRadius:q,children:t=>t.arcs.map(((o,r)=>{const[i,s]=t.path.centroid(o),n=o.endAngle-o.startAngle>=.25,d=e=>N(e,o.data),p={d:t.path(o)||"",fill:E.fill(o.data)};return c&&(p.onMouseMove=d,p.onMouseLeave=w),a("g",{children:[e("path",{...p}),n&&e("text",{x:i,y:s,dy:".33em",fill:j.labelBackgroundColor||l.labelBackgroundColor,fontSize:12,textAnchor:"middle",pointerEvents:"none",children:o.data.label})]},`arc-${r}`)}))})})}),u&&e(n,{items:Y,orientation:g,className:m["pie-chart-legend"]}),c&&V&&A&&e(p,{data:A,top:y||0,left:k||0,style:{transform:"translate(-50%, -100%)"}})]})};c.displayName="PieChart";var h=d(c);export{h as default};
//# sourceMappingURL=pie-chart.js.map
