import{jsx as e,jsxs as t,Fragment as a}from"react/jsx-runtime";import{AxisLeft as l,AxisBottom as i}from"@visx/axis";import{localPoint as o}from"@visx/event";import{Group as r}from"@visx/group";import{scaleOrdinal as n,scaleBand as s,scaleLinear as c}from"@visx/scale";import{Bar as d,Pie as h}from"@visx/shape";import{useTooltip as m}from"@visx/tooltip";import p from"clsx";import{createContext as g,useContext as u,useCallback as v}from"react";import{GridRows as _,GridColumns as b}from"@visx/grid";import{LegendOrdinal as f}from"@visx/legend";import{useParentSize as x}from"@visx/responsive";import{LinearGradient as y}from"@visx/gradient";import{buildChartTheme as w,XYChart as N,AnimatedGrid as k,AnimatedAxis as L,AnimatedLineSeries as T,AnimatedAreaSeries as M,Tooltip as D}from"@visx/xychart";import C from"@visx/shape/lib/shapes/Pie";import{Text as S}from"@visx/text";const F={backgroundColor:"#FFFFFF",labelBackgroundColor:"#FFFFFF",colors:["#98C8DF","#006DAB","#A6DC80","#1F9828","#FF8C8F"],gridStyles:{stroke:"#787C82",strokeWidth:1},tickLength:0,gridColor:"",gridColorDark:""},A=g(F),O=()=>u(A),z=({theme:t={},children:a})=>{const l={...F,...t};return e(A.Provider,{value:l,children:a})};var $="grid-control-module__grid-control__KOnZN";const I=({width:a,height:l,xScale:i,yScale:o,gridVisibility:r="x",top:n=0})=>t("g",{transform:`translate(0, ${n})`,className:$,children:[r.includes("x")&&e(_,{scale:i,width:a}),r.includes("y")&&e(b,{scale:o,height:l})]});var P={"legend--horizontal":"legend-module__legend--horizontal__IUN13","legend--vertical":"legend-module__legend--vertical__Scfzo","legend-item":"legend-module__legend-item__feemn","legend-item-swatch":"legend-module__legend-item-swatch__nRyXf","legend-item-label":"legend-module__legend-item-label__ksx6I","legend-item-value":"legend-module__legend-item-value__d9x1j"};const R={horizontal:"row",vertical:"column"},V=({items:a,className:l,orientation:i="horizontal"})=>{const o=n({domain:a.map((e=>e.label)),range:a.map((e=>e.color))});return e("div",{className:p(P.legend,P[`legend--${i}`],l),role:"list",children:e(f,{scale:o,direction:R[i],shape:"rect",shapeWidth:16,shapeHeight:16,className:P["legend-items"],children:l=>e("div",{className:P[`legend--${i}`],children:l.map((l=>t("div",{className:P["legend-item"],children:[e("svg",{width:16,height:16,children:e("rect",{width:16,height:16,fill:l.value,className:P["legend-item-swatch"]})}),t("span",{className:P["legend-item-label"],children:[l.text,a.find((e=>e.label===l.text))?.value&&e("span",{className:P["legend-item-value"],children:a.find((e=>e.label===l.text))?.value})]})]},l.text)))})})})};function B(t,a){const{maxWidth:l=1200,aspectRatio:i=.5,debounceTime:o=50}=a||{};return function(a){const{parentRef:r,width:n}=x({debounceTime:o,enableDebounceLeadingCall:!0,initialSize:{width:600,height:400}}),s=n?Math.min(n,l):600,c=s*i;return e("div",{ref:r,style:{width:"100%",minHeight:`${c}px`},children:e(t,{width:s,height:c,size:s,...a})})}}var K="base-tooltip-module__tooltip__OfX6n";const W=({data:e})=>t(a,{children:[e?.label,": ",e?.valueDisplay||e?.value]}),j=({data:t,top:a,left:l,component:i=W,children:o,className:r})=>e("div",{className:K,style:{top:a,left:l},role:"tooltip",children:o||t&&e(i,{data:t,className:r})});var q={"bar-chart":"bar-chart-module__bar-chart__lmYNi","bar-chart-legend":"bar-chart-module__bar-chart-legend__vgKKq"};const Y=({data:a,margin:n={top:20,right:20,bottom:40,left:40},withTooltips:h=!1,showLegend:g=!1,legendOrientation:u="horizontal",className:_,gridVisibility:b="x",width:f,height:x=400})=>{const y=O(),{tooltipOpen:w,tooltipLeft:N,tooltipTop:k,tooltipData:L,hideTooltip:T,showTooltip:M}=m(),D=v(((e,t,a,l,i)=>{const r=o(e);r&&M({tooltipData:{value:t,xLabel:a,yLabel:l,seriesIndex:i},tooltipLeft:r.x,tooltipTop:r.y-10})}),[M]),C=v((()=>{T()}),[T]);if(!a?.length)return e("div",{className:p("bar-chart-empty",q["bat-chart-empty"]),children:"Empty..."});const S=n,F=f-S.left-S.right,A=x-S.top-S.bottom,z=a[0].data?.map((e=>e?.label||"")),$=s({range:[0,F],domain:z,padding:.2}),P=s({range:[0,$.bandwidth()],domain:a.map(((e,t)=>t.toString())),padding:.1}),R=c({range:[A,0],domain:[0,Math.max(...a.map((e=>Math.max(...e.data.map((e=>e?.value||0))))))]}),B=a.map(((e,t)=>({label:e.label,value:"",color:y.colors[t%y.colors.length]})));return t("div",{className:p("bar-chart",_,q["bar-chart"]),children:[e("svg",{width:f,height:x,children:t(r,{left:S.left,top:S.top,children:[e(I,{width:F,height:A,xScale:$,yScale:R,gridVisibility:b}),a.map(((t,a)=>e(r,{children:t.data.map((l=>{const i=$(l?.label||"");if(void 0===i)return null;const o=P.bandwidth(),r=i+(P(a.toString())??0);return e(d,{x:r,y:R(l.value),width:o,height:A-(R(l.value)??0),fill:y.colors[a%y.colors.length],onMouseMove:h?e=>D(e,l.value,l?.label||"",t.label,a):void 0,onMouseLeave:h?C:void 0},`bar-${a}-${l.label}`)}))},a))),e(l,{scale:R}),e(i,{scale:$,top:A})]})}),h&&w&&L&&e(j,{top:k||0,left:N||0,children:t("div",{children:[e("div",{children:L.yLabel}),t("div",{children:[L.xLabel,": ",L.value]})]})}),g&&e(V,{items:B,orientation:u,className:q["bar-chart-legend"]})]})};Y.displayName="BarChart";var E=B(Y),G={"line-chart":"line-chart-module__line-chart__ITM3d","line-chart__tooltip":"line-chart-module__line-chart__tooltip__aqcme","line-chart__tooltip-date":"line-chart-module__line-chart__tooltip-date__4Dzab","line-chart__tooltip-row":"line-chart-module__line-chart__tooltip-row__6A37G","line-chart__tooltip-label":"line-chart-module__line-chart__tooltip-label__IvnFF"};const X=({tooltipData:a})=>{const l=a?.nearestDatum?.datum;if(!l)return null;const i=Object.entries(a?.datumByKey||{}).map((([e,{datum:t}])=>({key:e,value:t.value}))).sort(((e,t)=>t.value-e.value));return t("div",{className:G["line-chart__tooltip"],children:[e("div",{className:G["line-chart__tooltip-date"],children:l.date.toLocaleDateString()}),i.map((a=>t("div",{className:G["line-chart__tooltip-row"],children:[t("span",{className:G["line-chart__tooltip-label"],children:[a.key,":"]}),e("span",{className:G["line-chart__tooltip-value"],children:a.value})]},a.key)))]})},H=e=>new Date(e).toLocaleDateString(void 0,{month:"short",day:"numeric"});var Z=B((({data:l,width:i,height:o,margin:r={top:20,right:20,bottom:40,left:40},className:n,withTooltips:s=!0,showLegend:c=!1,legendOrientation:d="horizontal",withGradientFill:h=!1,options:m={}})=>{const g=O();if(!l?.length)return e("div",{className:p("line-chart-empty",G["line-chart-empty"]),children:"Empty..."});const u=l.map(((e,t)=>({label:e.label,value:"",color:g.colors[t%g.colors.length]}))),v={xAccessor:e=>e.date,yAccessor:e=>e.value},_=w({backgroundColor:g.backgroundColor,colors:g.colors,gridStyles:g.gridStyles,tickLength:g?.tickLength||0,gridColor:g?.gridColor||"",gridColorDark:g?.gridColorDark||""});return t("div",{className:p("line-chart",G["line-chart"],n),children:[t(N,{theme:_,width:i,height:o,margin:r,xScale:{type:"time"},yScale:{type:"linear",nice:!0},children:[e(k,{columns:!1,numTicks:4}),e(L,{orientation:"bottom",numTicks:5,tickFormat:H,...m?.axis?.x}),e(L,{orientation:"left",numTicks:4,...m?.axis?.y}),l.map(((l,i)=>{const o=l.options?.stroke??_.colors[i%_.colors.length];return t(a,{children:[e(y,{id:`area-gradient-${i+1}`,from:o,to:"white",toOpacity:.1,...l.options?.gradient}),e(T,{dataKey:l?.label,data:l.data,...v,stroke:o,strokeWidth:2},l?.label),h&&e(M,{dataKey:l?.label,data:l.data,...v,stroke:o,strokeWidth:0,fill:`url(#area-gradient-${i+1})`,renderLine:!1},l?.label)]})})),s&&e(D,{snapTooltipToDatumX:!0,snapTooltipToDatumY:!0,showSeriesGlyphs:!0,renderTooltip:X})]}),c&&e(V,{items:u,orientation:d,className:G["line-chart-legend"]})]})}));const Q=({withTooltips:e})=>{const{tooltipOpen:t,tooltipLeft:a,tooltipTop:l,tooltipData:i,hideTooltip:r,showTooltip:n}=m();return{onMouseMove:v(((t,a)=>{if(!e)return;const l=o(t);l&&n({tooltipData:a,tooltipLeft:l.x,tooltipTop:l.y-10})}),[e,n]),onMouseLeave:v((()=>{e&&r()}),[e,r]),tooltipOpen:t,tooltipData:i||null,tooltipLeft:a,tooltipTop:l}};var U={"pie-chart":"pie-chart-module__pie-chart__R12Vh"};const J=({data:a,withTooltips:l=!1,className:i,showLegend:o,legendOrientation:n,size:s,thickness:c=1,padding:d=20,gapScale:m=0,cornerScale:g=0})=>{const u=O(),{onMouseMove:v,onMouseLeave:_,tooltipOpen:b,tooltipData:f,tooltipLeft:x,tooltipTop:y}=Q({withTooltips:l}),{isValid:w,message:N}=(e=>{if(!e.length)return{isValid:!1,message:"No data available"};if(e.some((e=>e.percentage<0||e.value<0)))return{isValid:!1,message:"Invalid data: Negative values are not allowed"};const t=e.reduce(((e,t)=>e+t.percentage),0);return Math.abs(t-100)>.01?{isValid:!1,message:"Invalid percentage total: Must equal 100"}:{isValid:!0,message:""}})(a);if(!w)return e("div",{className:p("pie-chart",U["pie-chart"],i),children:e("div",{className:U["error-message"],children:N})});const k=s,L=s,T=Math.min(k,L)/2,M=k/2,D=L/2,C=m*(2*Math.PI/a.length),S=T-d,A=S*(1-c),z=(S-A)/2,$=g?Math.min(g*S,z):0,I=a.map(((e,t)=>({...e,index:t}))),P={value:e=>e.value,fill:e=>e?.color||u.colors[e.index]},R=a.map(((e,t)=>({label:e.label,value:e.value.toString(),color:u.colors[t%u.colors.length]})));return t("div",{className:p("pie-chart",U["pie-chart"],i),children:[e("svg",{viewBox:`0 0 ${s} ${s}`,preserveAspectRatio:"xMidYMid meet",children:e(r,{top:D,left:M,children:e(h,{data:I,pieValue:P.value,outerRadius:S,innerRadius:A,padAngle:C,cornerRadius:$,children:a=>a.arcs.map(((i,o)=>{const[r,n]=a.path.centroid(i),s=i.endAngle-i.startAngle>=.25,c=e=>v(e,i.data),d={d:a.path(i)||"",fill:P.fill(i.data)};return l&&(d.onMouseMove=c,d.onMouseLeave=_),t("g",{children:[e("path",{...d}),s&&e("text",{x:r,y:n,dy:".33em",fill:u.labelBackgroundColor||F.labelBackgroundColor,fontSize:12,textAnchor:"middle",pointerEvents:"none",children:i.data.label})]},`arc-${o}`)}))})})}),o&&e(V,{items:R,orientation:n,className:U["pie-chart-legend"]}),l&&b&&f&&e(j,{data:f,top:y||0,left:x||0,style:{transform:"translate(-50%, -100%)"}})]})};J.displayName="PieChart";var ee=B(J),te="pie-semi-circle-chart-module__pie-semi-circle-chart__r5jk9",ae="pie-semi-circle-chart-module__pie-semi-circle-chart-legend__c8W1Y",le="pie-semi-circle-chart-module__label__nPqOg",ie="pie-semi-circle-chart-module__note__LpBZQ";const oe=({data:a,size:l=500,label:i,note:n,className:s,withTooltips:c=!1,clockwise:d=!0,thickness:h=.4,showLegend:g,legendOrientation:u})=>{const _=O(),{tooltipOpen:b,tooltipLeft:f,tooltipTop:x,tooltipData:y,hideTooltip:w,showTooltip:N}=m(),k=l/2,L=l/2,T=l/2,M=T*(1-h+.03),D=a.map(((e,t)=>({...e,index:t}))),F=d?-Math.PI/2:Math.PI/2,A=d?Math.PI/2:-Math.PI/2,z={value:e=>e.value,sort:(e,t)=>t.value-e.value,fill:e=>e.color||_.colors[e.index%_.colors.length]},$=v(((e,t)=>{const a=o(e);a&&N({tooltipData:t.data,tooltipLeft:a.x,tooltipTop:a.y-10})}),[N]),I=v((()=>{w()}),[w]),P=v((e=>t=>{$(t,e)}),[$]),R=a.map(((e,t)=>({label:e.label,value:e.valueDisplay||e.value.toString(),color:z.fill({...e,index:t})})));return t("div",{className:p("pie-semi-circle-chart",te,s),children:[e("svg",{viewBox:`0 0 ${l} ${L}`,children:t(r,{top:k,left:k,children:[e(C,{data:D,pieValue:z.value,outerRadius:T,innerRadius:M,cornerRadius:3,padAngle:.03,startAngle:F,endAngle:A,pieSort:z.sort,children:t=>t.arcs.map((a=>e("g",{onMouseMove:P(a),onMouseLeave:I,children:e("path",{d:t.path(a)||"",fill:z.fill(a.data)})},a.data.label)))}),t(r,{children:[e(S,{textAnchor:"middle",verticalAnchor:"start",y:-40,className:le,children:i}),e(S,{textAnchor:"middle",verticalAnchor:"start",y:-20,className:ie,children:n})]})]})}),c&&b&&y&&e(j,{data:{label:y.label,value:y.value,valueDisplay:y.valueDisplay},top:x||0,left:f||0}),g&&e(V,{items:R,orientation:u,className:ae})]})};oe.displayName="PieSemiCircleChart";var re=B(oe);export{E as BarChart,j as BaseTooltip,V as Legend,Z as LineChart,ee as PieChart,re as PieSemiCircleChart,z as ThemeProvider,Q as useChartMouseHandler};
//# sourceMappingURL=index.js.map
